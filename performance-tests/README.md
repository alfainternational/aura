# اختبارات الأداء لتطبيق أورا

هذا المجلد يحتوي على مجموعة من اختبارات الأداء والتحميل لتطبيق أورا باستخدام أداة k6. تهدف هذه الاختبارات إلى قياس أداء التطبيق تحت ظروف مختلفة من الحمل وضمان قدرته على التعامل مع عدد كبير من المستخدمين المتزامنين.

## المتطلبات

1. تثبيت أداة k6: [https://k6.io/docs/getting-started/installation/](https://k6.io/docs/getting-started/installation/)
2. تشغيل تطبيق أورا على الخادم المحلي (http://localhost:8000)
3. إنشاء مستخدمين للاختبار (يمكن استخدام سكريبت إنشاء البيانات الوهمية)

## ملفات الاختبار

1. **config.js**: يحتوي على إعدادات الاختبار مثل عنوان API وعدد المستخدمين المتزامنين ومدة الاختبار وأهداف الأداء.
2. **helpers.js**: يحتوي على دوال مساعدة تستخدم في اختبارات الأداء.
3. **authentication-load-test.js**: اختبار أداء عمليات المصادقة (تسجيل الدخول، التسجيل، تسجيل الخروج).
4. **messaging-load-test.js**: اختبار أداء وظائف المراسلة (إنشاء محادثات، إرسال رسائل، قراءة رسائل).
5. **voice-call-load-test.js**: اختبار أداء المكالمات الصوتية (بدء مكالمة، قبول مكالمة، إنهاء مكالمة).
6. **admin-dashboard-load-test.js**: اختبار أداء لوحة تحكم المسؤول (عرض المستخدمين، الإحصائيات، تفاصيل المستخدمين).
7. **integrated-load-test.js**: اختبار أداء متكامل يحاكي سيناريوهات واقعية للمستخدمين.

## كيفية تشغيل الاختبارات

### إعداد بيانات الاختبار

قبل تشغيل اختبارات الأداء، يجب إنشاء بيانات وهمية كافية في قاعدة البيانات. يمكن استخدام سكريبت Laravel Seeder لإنشاء:

```bash
php artisan db:seed --class=PerformanceTestSeeder
```

### تشغيل اختبار فردي

```bash
k6 run authentication-load-test.js
```

### تشغيل اختبار مع تعديل المعلمات

```bash
k6 run --vus 50 --duration 60s messaging-load-test.js
```

### تشغيل اختبار وحفظ النتائج

```bash
k6 run --out json=results.json messaging-load-test.js
```

## تفسير النتائج

بعد تشغيل الاختبار، ستظهر النتائج في وحدة التحكم. تتضمن النتائج:

1. **معدل الطلبات**: عدد الطلبات في الثانية.
2. **زمن الاستجابة**: متوسط زمن الاستجابة، والقيم المئوية (p95, p99).
3. **معدل النجاح**: نسبة الطلبات الناجحة.
4. **استخدام الموارد**: استخدام وحدة المعالجة المركزية والذاكرة.

## أهداف الأداء

تم تعيين أهداف الأداء التالية في ملف config.js:

1. 95% من الطلبات يجب أن تكون أقل من 500 مللي ثانية.
2. 99% من الطلبات يجب أن تكون أقل من 1000 مللي ثانية.
3. معدل النجاح يجب أن يكون أعلى من 95%.

## توصيات لتحسين الأداء

إذا فشلت الاختبارات في تحقيق أهداف الأداء، فيمكن النظر في التحسينات التالية:

1. **تحسين قاعدة البيانات**: إضافة فهارس، تحسين الاستعلامات.
2. **التخزين المؤقت**: استخدام Redis للتخزين المؤقت.
3. **توزيع الحمل**: استخدام موازن الحمل وتوزيع التطبيق على عدة خوادم.
4. **تحسين الكود**: تحديد وتحسين الأجزاء البطيئة من الكود.
5. **تحسين الصور والوسائط**: ضغط الصور، استخدام CDN.

## سيناريوهات اختبار إضافية

يمكن إنشاء سيناريوهات اختبار إضافية حسب الحاجة، مثل:

1. اختبار استقرار طويل المدى (24 ساعة).
2. اختبار الاسترداد من الفشل.
3. اختبار الحمل المفاجئ (Spike Testing).
